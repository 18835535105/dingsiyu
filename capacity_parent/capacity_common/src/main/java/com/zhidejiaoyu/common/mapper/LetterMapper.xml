<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zhidejiaoyu.common.mapper.LetterMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.zhidejiaoyu.common.pojo.Letter">
        <id column="id" property="id" />
        <result column="big_letter" property="bigLetter" />
        <result column="lowercase_letters" property="lowercaseLetters" />
        <result column="unit_id" property="unitId" />
        <result column="type" property="type" />
        <result column="gif_url" property="gifUrl" />
    </resultMap>

    <sql id="base_sql">
        id,big_letter,lowercase_letters,unit_id,type,gif_url
    </sql>

    <select id="selLetterCountById" resultType="integer" parameterType="long">
        select count(id) from letter where unit_id =#{unitId}
    </select>

    <select id="getByUnitId" parameterType="long" resultMap="BaseResultMap">
        select <include refid="base_sql"></include> from letter where unit_id=#{unitId}
    </select>

    <select id="getStudyLetter" parameterType="map" resultMap="BaseResultMap">
        select <include refid="base_sql"></include> from letter
        where unit_id=#{unitId}
        <if test="longs!=null and longs.size>0">
            and id not in(
            <foreach collection="longs" separator="," item="long">
                #{long}
            </foreach>
            )
        </if>
        order by id
        limit 1
    </select>

    <select id="getAllLetterByUnitId" parameterType="integer" resultMap="BaseResultMap">
        select <include refid="base_sql"></include> from letter where unit_id=#{unitId}
    </select>

    <select id="getThreeLetter" parameterType="map" resultMap="BaseResultMap">
        select <include refid="base_sql"></include> from letter where id &lt;> #{letterId} order by rand() limit 3
    </select>

</mapper>
